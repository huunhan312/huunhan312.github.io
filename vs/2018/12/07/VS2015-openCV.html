<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Visual Studio 2015 and opencv 3.3.1 | KidoCode</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Visual Studio 2015 and opencv 3.3.1" />
<meta name="author" content="nhannh" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post I will note a way to use opencv in Visual studio 2015. opencv is an power tool to deal with image, video." />
<meta property="og:description" content="In this post I will note a way to use opencv in Visual studio 2015. opencv is an power tool to deal with image, video." />
<link rel="canonical" href="http://localhost:4000/vs/2018/12/07/VS2015-openCV.html" />
<meta property="og:url" content="http://localhost:4000/vs/2018/12/07/VS2015-openCV.html" />
<meta property="og:site_name" content="KidoCode" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-07T00:00:00+09:00" />
<script type="application/ld+json">
{"dateModified":"2018-12-07T00:00:00+09:00","datePublished":"2018-12-07T00:00:00+09:00","url":"http://localhost:4000/vs/2018/12/07/VS2015-openCV.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/vs/2018/12/07/VS2015-openCV.html"},"headline":"Visual Studio 2015 and opencv 3.3.1","author":{"@type":"Person","name":"nhannh"},"description":"In this post I will note a way to use opencv in Visual studio 2015. opencv is an power tool to deal with image, video.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/jeju2016.PNG"},"name":"nhannh"},"@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
		<div class="header">
      <header>
        <!-- <h1><a href="http://localhost:4000/">KidoCode</a></h1> -->
        
		<!-- Logo and description -->
        
          <img src="/assets/img/jeju2016.PNG" alt="Logo" />
        

        <p></p>
		
		<!-- Github link default -->
		
        	
		
        
		
		<!-- My menu -->	
		
		<nav>
  <!--
    <a href="/" >Home</a>	
  
    <a href="/notes/vs.html" >Visual Studio</a>	
  
    <a href="/notes/dip.html" >Image processing</a>	
  
    <a href="/notes/code.html" >Programming notes</a>	
  
    <a href="/notes/nn.html" >Neural Network</a>	
  
    <a href="/basic_markdown.html" >Basic Markdown</a>	
  
   -->
  
        <p class="view"><a href="/" >Home</a></p>
   
        <p class="view"><a href="/notes/vs.html" >Visual Studio</a></p>
   
        <p class="view"><a href="/notes/dip.html" >Image processing</a></p>
   
        <p class="view"><a href="/notes/code.html" >Programming notes</a></p>
   
        <p class="view"><a href="/notes/nn.html" >Neural Network</a></p>
   
        <p class="view"><a href="/basic_markdown.html" >Basic Markdown</a></p>
   
   

</nav>
		
		<!--
		
        <p class="view"><a href="/">About</a></p>
        
		
		
        <p class="view"><a href="" >Blog</a></p>
        
		-->
		<!-- Download link -->
        
		
		<!-- Theme info -->
		<p><small>Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </header>
	  
	  
      <section>	  

		<h1>Visual Studio 2015 and opencv 3.3.1</h1>
<small>7 December 2018</small>
<hr>

<!--
<p class="view">by nhannh</p>
-->

<p>In this post I will note a way to use opencv in Visual studio 2015. opencv is an power tool to deal with image, video.</p>

<h2 id="1-download-opencv-331">1. Download opencv 3.3.1</h2>

<p>OpenCV is an useful, well-known library to programmer/student, who are interested in image processing. It is open, free and very easy to use on both Windows or Linux environment.</p>

<p>You guys can download the source code and build library to fit with your hardware or simply download an available pre-built package. In this post, I download a version of opencv from <a href="https://sourceforge.net/projects/opencvlibrary/files/opencv-win/">sourceforge</a>, then use it directly as a library in my VSC++ program.</p>

<p>This post implement with Visual Studio 2015 and opencv 3.3.1.</p>

<h2 id="2-create-c-solution-and-project">2. Create C++ solution and project</h2>

<p>Create an empty c++ project as following figure.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/vs-createProj.png" alt="create project" title="Create an empty project" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 1: <em>Create an empty project</em></td>
    </tr>
  </tbody>
</table>

<h2 id="3-add-opencv-library-into-the-project">3. Add OpenCV library into the project</h2>

<p>There are two methods to add libraries to VS project.</p>

<p>The first method copy directly library files to VS project’s location. If you copy the project to another PC, you do not need to set up again. However, it will occupy space if you have many such projects.</p>

<p>The second method is to put library at some place, then referring your project to that library. The project may be not working if you change library or project location.</p>

<h3 id="31-method-1-add-opencv-directly-in-vs-project">3.1 Method 1: Add OpenCV directly in VS Project</h3>

<p>After extracting OpenCV library to some place, you can copy only several necessary folders below into your VS project.</p>

<p>For example, I copy opencv331 to VS project and keep folders as follows. Note that, depending on your OpenCV version, VS version and platform, it maybe x32 or vc12, blah.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test.slm
test.vcxproj
opencv331
|
+----- include
|
+----- x64
        |
        +----- vc14
                |
                +----- bin
                |
                +----- lib

</code></pre></div></div>

<p><strong>3.1.1 Adding API path</strong></p>

<p>When coding, we usually use opencv functions and your compiler need to know where they are. They can be call via a API, which only comprise of declarations. In <em>C/C++</em>, the API is files following with extension <em>*.h/*.hpp</em>.</p>

<p>To add OpenCV API, <strong>right click to projects → Properties → click General at C/C++ section</strong>. Then add the path of include folder in OpenCV library to <strong><em>Additional Include Directories</em></strong>.</p>

<p>Notes that the project file (*.vcxproj) is considered as the current directory. If the structure of your project is similar to <em>Fig 1</em>, your path should be: <strong><em>opencv331/include</em></strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/vs-add-include.png" alt="fig2" title="Add include path" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 2: <em>Adding API path</em></td>
    </tr>
  </tbody>
</table>

<p>By include the header file (*.h), your code won’t display the errors as ‘not found’, ‘not declaration’, blah.</p>

<p><strong>3.1.2 Adding library path and specify library files</strong></p>

<p>However, the compiler needs the real definitions from built library during linking process. The programmer should have to provide these information in advanced.</p>

<p>There are two parameters for this steps.</p>

<p>Firstly, we specify the path to library files, where contains *.lib files. In the <strong>Properties dialog → Linker → General</strong>, create a new row and add your path to <strong>Additional Library Directories</strong>.</p>

<p>In this example, the path should be <strong><em>opencv331/x64/vc14/lib</em></strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/vs-add-lib-dir.png" alt="fig3" title="Add lib path" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 3: <em>Adding library path</em></td>
    </tr>
  </tbody>
</table>

<p>Secondly, specify the name related files. In the <strong>Properties dialog → Linker → Input</strong>, create row and add the name of library files to <strong>Additional Dependencies</strong>.</p>

<p>For version <strong>3.3.1</strong>, opencv only one library file namely <strong><em>opencv_world_331.lib</em></strong> or <strong><em>opencv_world_331d.lib</em></strong>.</p>

<p>Notes:</p>
<ul>
  <li>The suffix <strong>d</strong> means debug. When setting the Visual Studio, we will use the file name without <strong>d</strong> for <strong>Release</strong> mode and with <strong>d</strong> for <strong>Debug</strong> mode.</li>
  <li>The older versions of opencv has many library files, all of them have the same name style above. Your job in this case is listing all files corresponding to <strong>Release/Debug</strong> mode.</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/vs-add-lib.png" alt="fig4" title="Add lib file" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 4: <em>Adding library files</em></td>
    </tr>
  </tbody>
</table>

<p><strong>3.1.3 Adding debugging path</strong></p>

<p>The opencv library built as dynamic link library (dll) should appear in the same output directory, where contains the executive file after build, especially for debug mode.</p>

<p>We can setting this dependency files by specify the path of dll files to visual studio.</p>

<p>In the <strong>Properties dialog → Debugging</strong>, add following syntax to <strong>Environment</strong> option: <strong><em>PATH=opencv331\x64\vc14\bin;%PATH%</em></strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/vs-add-debugging-environment.png" alt="fig5" title="Add debugging environment" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 5: <em>Setting the debugging environment</em></td>
    </tr>
  </tbody>
</table>

<h3 id="32-method-2-add-opencv-via-environment-variable-or-direct-path">3.2 Method 2: Add OpenCV via environment variable or direct path</h3>

<p>If there are lots of projects locate only in your PC, you can store opencv331 at some place and then apply direct path as the <strong>Method 1</strong> above.</p>

<p>Besides, we can use a <em>string variable</em> to store the real library path, then using this variable to declare your real path to Visual Studio.</p>

<p>In Windows, we can define this variable under system variable as follows: <strong>Right click My Commputer or This PC → Properties → Advanced system settings → Advanced → Environment Variables…</strong></p>

<p>In the <strong>System variables</strong>, create new variable as Fig 6. Here, I assume that you extract opencv331 in C:\ drive.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/assets/vs-000-vs2015opencv331/fig6-system-variable.png" alt="fig6" title="Define new system variable" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Fig 6: <em>Define new system variable</em></td>
    </tr>
  </tbody>
</table>

<p>Now, we just need to append the path of further directories/files to $(OPENCV) and add the path to Visual Studio. By doing this, if you change opencv library to onather place, you just need to change the values of environment variable.</p>

<p>For example, the path of dll files: <strong>$(OPENCV)\x64\vc14\bin</strong></p>

<h2 id="4-test">4. Test</h2>
<p>Lets test an example code to read and display frame from video using OpenCV</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;opencv2/core/core.hpp&gt;
#include &lt;opencv2/highgui/highgui.hpp&gt;
#include &lt;iostream&gt;
</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">cv</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">" Usage: display_image ImageToLoadAndDisplay"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
     <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Mat</span> <span class="n">image</span><span class="p">;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">CV_LOAD_IMAGE_COLOR</span><span class="p">);</span>   <span class="c1">// Read the file</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="n">image</span><span class="p">.</span><span class="n">data</span> <span class="p">)</span>                              <span class="c1">// Check for invalid input</span>
    <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span>  <span class="s">"Could not open or find the image"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="p">;</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">namedWindow</span><span class="p">(</span> <span class="s">"Display window"</span><span class="p">,</span> <span class="n">WINDOW_AUTOSIZE</span> <span class="p">);</span><span class="c1">// Create a window for display.</span>
    <span class="n">imshow</span><span class="p">(</span> <span class="s">"Display window"</span><span class="p">,</span> <span class="n">image</span> <span class="p">);</span>                   <span class="c1">// Show our image inside it.</span>

    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>                                          <span class="c1">// Wait for a keystroke in the window</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>



<!--

  <small>tags: <em>vs</em></small>

-->
<hr>
<p>This blog stores notes as personal purpose. Please leave issue in my github if you want to have further discussion.</p>

      </section>
	  
	  <sidebar>
	     <!-- 

  <!-- <h3>vs</h3> 
  <ul>
    
      <li><a href="/vs/2018/12/07/VS2015-openCV.html" class="current">Visual Studio 2015 and opencv 3.3.1</a></li>
    
  </ul>

  <!-- <h3>nn</h3> 
  <ul>
    
      <li><a href="/nn/2018/12/22/lossfunction.html" >Popular loss functions</a></li>
    
  </ul>

-->
<!--

	<hr>
    
      <li><a href="/vs/2018/12/07/VS2015-openCV.html" class="current">Visual Studio 2015 and opencv 3.3.1</a></li>
    

	<hr>
    
      <li><a href="/nn/2018/12/22/lossfunction.html" >Popular loss functions</a></li>
    

<hr>
-->
<i>Recent posts</i>
<br />

   <a href="/nn/2018/12/22/lossfunction.html" >Popular loss functions</a><br />

   <a href="/vs/2018/12/07/VS2015-openCV.html" class="current">Visual Studio 2015 and opencv 3.3.1</a><br />


	  </sidebar>
	  
      <footer>
        
       
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    
  </body>
</html>
